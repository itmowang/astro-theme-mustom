<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.12.2"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://blog5.loli.wang/page/2/"><!-- Primary Meta Tags --><title>魔王 の 博客</title><meta name="title" content="魔王 の 博客"><meta name="description" content="魔王 の部落阁"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://blog5.loli.wang/page/2/"><meta property="og:title" content="魔王 の 博客"><meta property="og:description" content="魔王 の部落阁"><meta property="og:image" content="https://blog5.loli.wang/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog5.loli.wang/page/2/"><meta property="twitter:title" content="魔王 の 博客"><meta property="twitter:description" content="魔王 の部落阁"><meta property="twitter:image" content="https://blog5.loli.wang/blog-placeholder-1.jpg"><link rel="stylesheet" href="/_astro/about.82merU4V.css">
<style>footer[data-astro-cid-sz7xmlte]{padding:2em 1em 6em;background:linear-gradient(var(--gray-gradient)) no-repeat;color:rgb(var(--gray));text-align:center}.social-links[data-astro-cid-sz7xmlte]{display:flex;justify-content:center;gap:1em;margin-top:1em}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]{text-decoration:none;color:rgb(var(--gray))}.social-links[data-astro-cid-sz7xmlte] a[data-astro-cid-sz7xmlte]:hover{color:rgb(var(--gray-dark))}
</style><script type="module">const o=document.querySelectorAll(".theme-controller");o.forEach(e=>{e.addEventListener("change",function(t){t.target.checked&&(localStorage.setItem("theme",t.target.checked),c(t.target.checked))})});function c(e){console.log("已经切换主题",e)}document.addEventListener("DOMContentLoaded",function(){const e=localStorage.getItem("theme");if(e){c(e);const t=document.querySelector(`input[value="${e}"]`);t&&(t.checked=!0)}});
</script></head> <body> <header class="w-full fixed z-10 header-theme hover:shadow-md transition ease-in-out delay duration-300"> <nav class="flex items-center justify-center  w-full "> <div class="text-xl leading-[80px] header-nav"> <a href="/" class="mx-2 header-nav-item" data-astro-cid-eimmu3lg> 首页 </a>  <a href="/blog" class="mx-2 header-nav-item" data-astro-cid-eimmu3lg> 归档 </a>  <a href="/about" class="mx-2 header-nav-item" data-astro-cid-eimmu3lg> 关于 </a>  <a href="/link" class="mx-2 header-nav-item" data-astro-cid-eimmu3lg> 友链 </a>  </div> <div class="flex items-center"> <a href="https://m.webtoo.ls/@astro" class="ml-2 mr-2" target="_blank"> <span class="sr-only">Follow Astro on Mastodon</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill="currentColor" d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.16-4.339.16-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.168 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z"></path></svg> </a> <a href="https://twitter.com/astrodotbuild" class="mr-2" target="_blank"> <span class="sr-only">Follow Astro on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.165 9.165 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.163 3.163 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.616 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.16 6.16 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"></path></svg> </a> <a href="https://github.com/withastro/astro" class="mr-2" target="_blank"> <span class="sr-only">Go to Astro's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.16-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path></svg> </a> </div> </nav> </header> <main> <div class="relative"> <div class="bg-urls bg-no-repeat bg-cover h-dvh bg-center relative"> <div class="absolute inset-0 bg-gradient-to-t from-white"></div> </div> <div class="absolute inset-0"> <div class="min-h-dvh">  <div class="container mx-auto"> <div class="flex pt-[120px]"> <!-- 左侧信息 --> <div class="w-2/6"> <div class="myCard card card-side bg-color shadow-xl"> <figure> <img src="https://d-sketon.top/img/_backwebp/bg26.webp" alt="Movie" class="h-full w-[200px] object-cover object-top"> </figure> <div class="card-body p-4"> <h2 class="card-title flex justify-center my-title">MoWang</h2> <div class="flex justify-center my-desc">魔王的 Blog </div> <div class="flex w-full flex-col lg:flex-row"> <div class="card rounded-box grid h-16 flex-grow place-items-center"> <div> <div class="flex justify-center my-cate">文章</div> <div class="flex justify-center my-number">11</div> </div> </div> <div class="divider sm:divider-horizontal"></div> <div class="card rounded-box grid h-16 flex-grow place-items-center"> <div> <div class="flex justify-center my-cate">分类</div> <div class="flex justify-center my-number">11</div> </div> </div> <div class="divider sm:divider-horizontal"></div> <div class="card rounded-box grid h-16 flex-grow place-items-center"> <div> <div class="flex justify-center my-cate">标签</div> <div class="flex justify-center my-number">11</div> </div> </div> </div> <div class="flex justify-between"> <div> <button class="btn btn-sm btn-outline btn-primary">首页</button> </div> <div> <button class="btn btn-sm btn-outline btn-primary">归档</button> </div> <div> <button class="btn btn-sm btn-outline btn-primary">关于</button> </div> </div> <div class="decoration-wavy italic text-center my-yy">年少不得之物,终将困其一生</div> </div> </div> <div class="mt-6"> <div class="card bg-color  shadow-xl"> <div class="card-body"> <h2 class="card-title">标签云预留点</h2> <p> 后续你打算做点什么?</p> </div> </div> </div> <div class="mt-6"> <div class="card bg-color shadow-xl"> <div class="card-body"> <h2 class="card-title">Theme</h2> <div class="form-control"> <label class="label cursor-pointer gap-4"> <span class="label-text">春</span> <input type="radio" name="theme-radios" class="radio theme-controller" value="spring"> </label> </div> <div class="form-control"> <label class="label cursor-pointer gap-4"> <span class="label-text">夏</span> <input type="radio" name="theme-radios" class="radio theme-controller" value="summer"> </label> </div> <div class="form-control"> <label class="label cursor-pointer gap-4"> <span class="label-text">秋</span> <input type="radio" name="theme-radios" class="radio theme-controller" value="autumn"> </label> </div> <div class="form-control"> <label class="label cursor-pointer gap-4"> <span class="label-text">冬</span> <input type="radio" name="theme-radios" class="radio theme-controller" value="winter"> </label> </div> </div> </div>  </div> </div> <!-- 右侧列表或者内容 --> <div class="w-4/6 mb-4"> <div class="ml-4"><a href="/blog/2024-06-23-web-husky/doc/index.html" title="husky 的安装和使用"><div class="card bg-color cursor-pointer	 postCard rounded-lg w-full mb-4 shadow-xl flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"><time datetime="Sun Jun 23 2024 23:27:24 GMT+0800 (中国标准时间)">2024/6/23</time></div><div class="text-sm mr-6">0.1K字</div><div class="text-sm">39 天前</div></div></div><div class="flex justify-between items-center mt-2"><div class="w-5/6"><div class="text-2xl font-medium title line-clamp-1 leading-relaxed">husky 的安装和使用</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed"> 

## 什么是husky

    Husky 是一个用于 Git hooks 的工具，它能够在特定的 Git 操作（如 commit、push 等）之前或之后自动运行脚本，从而帮助开发者保持代码质量、执行代码检查、自动化任务等。将白了，用来约束git的。

## 安装并使用husky

1. 安装

``` bash
# npm 安装
npm install husky -D
# yarn 安装
yarn add husky -D
#pnpm 安装 
pnpm add husky -D
```

2. 配置husky

在给前端项目配置husky的之前一定要给项目建立版本控制

```bash
# 建立 git 版本控制
git init

```

使用指令创建husky配置, 会自动创建.husky文件夹，里面会包含git hooks的配置等。

```bash
# 指令创建 (老版本是这样)
npx husky install
# 指令创建 (新版本)
npx husky init

```

![1](http://img.blog.loli.wang/2024-06-23-web-husky/01.png)


测试配置是否成功

``` bash
git commit -m &quot;Keep calm and commit&quot;
```
 
可以看到我们提交命令被拦截了，不能被自由的正常使用git commit

![2](http://img.blog.loli.wang/2024-06-23-web-husky/02.png)


3. 创建husky钩子

创建一个husky钩子，让我们使用 npm test 的时候执行 .husky/pre-commit 的提交规则

```bash
echo &quot;npm test&quot; &gt; .husky/pre-commit
```

可以看到.husky 文件夹中增加了一个 pre-commit的文件

![3](http://img.blog.loli.wang/2024-06-23-web-husky/03.png)

里面会有一个 npm test 的指令代表 你每次执行 git commit 的时候就会先执行 npm test 指令，然后再走正常的git commit

![4](http://img.blog.loli.wang/2024-06-23-web-husky/04.png)


-------- 剩下的交给下个文章再写 《使用husky提交代码时使用eslint检测代码》</div></div><div><img src="http://img.blog.loli.wang/2024-06-23-web-husky/01.png" class="w-[500px] h-[200px] rounded-r-lg object-cover" style="clip-path:polygon(0 0,100% 0,100% 100%,20% 100%)"></div></div></div></a></div><div class="ml-4 "><a href="/blog/2024-05-29-consolelog/doc/index.html" title="好玩的console - 水一篇"><div class="card bg-color postCard mb-4 rounded-lg w-full shadow-xl cursor-pointer	 flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div><img src="http://img.blog.loli.wang/2024-05-29-consolelog/06.png" class="w-[500px] h-[200px] rounded-l-lg" style="clip-path:polygon(0 0,88% 0,100% 100%,0 100%)"></div><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"> <time datetime="Wed May 29 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/29</time> </div><div class="text-sm mr-6">0.1K字</div><div class="text-sm">64 天前</div></div></div><div class="flex justify-between items-center mt-2"><div><div class="text-2xl font-medium title">好玩的console - 水一篇</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed">

## console.log

常规的打印

```jsx
console.log(&quot;魔王&quot;);
```

![1](http://img.blog.loli.wang/2024-05-29-consolelog/01.png)

## console.warm

警告的打印

```jsx
console.warn(&quot;魔王&quot;);
```

![2](http://img.blog.loli.wang/2024-05-29-consolelog/02.png)


## console.error

错误的打印


```jsx
console.error(&quot;魔王&quot;);
```


![3](http://img.blog.loli.wang/2024-05-29-consolelog/03.png)


## console.dir

输出对象

```jsx
 const obj = { name: &quot;魔王&quot;, age: 999 };
 console.dir(obj);
```

![4](http://img.blog.loli.wang/2024-05-29-consolelog/04.png)


## console.clear()

清空控制台

```jsx
console.clear();
```

![5](http://img.blog.loli.wang/2024-05-29-consolelog/05.png)


## console.table

以表格的形式输出对象或者数组

```jsx
const test = [&quot;Apple&quot;, &quot;Banana&quot;, &quot;Orange&quot;];
    const test1 = {
      name: &quot;mowang&quot;,
      age: 999,
    };
    console.table(test);
    console.table(test1);
```

![6](http://img.blog.loli.wang/2024-05-29-consolelog/06.png)


## console.assert()

用于条件不满足的时候输出信息


```jsx
console.assert(2 + 2 === 5, &quot;2+2不等于5&quot;);
```

![7](http://img.blog.loli.wang/2024-05-29-consolelog/07.png)

</div></div></div></div></a></div><div class="ml-4"><a href="/blog/2024-05-27-webupload/doc/index.html" title="前端大文件切片上传以及使用webWorker"><div class="card bg-color cursor-pointer	 postCard rounded-lg w-full mb-4 shadow-xl flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"><time datetime="Tue May 28 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/28</time></div><div class="text-sm mr-6">0.3K字</div><div class="text-sm">65 天前</div></div></div><div class="flex justify-between items-center mt-2"><div class="w-5/6"><div class="text-2xl font-medium title line-clamp-1 leading-relaxed">前端大文件切片上传以及使用webWorker</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed"> 
常规项目日常开发的时候我们经常用到上传这个功能,一般日常的话不会有很大的文件上传，但是就是有不长眼的需求过来。 == 
 
## 切片上传优点

 - 大文件分割，切片后分批上传，减轻服务器压力
 - 断点续传，可以记录上传位置，方便上次上传未结束的操作
 - 上传进度控制的功能，不然无法知道文件是否上传的进度。
  
为什么使用web worker

 - 让线程不阻塞 ，切片 和 上传大文件是一个比较耗费时间的操作，如果在主要线程直行这个操作，容易卡死和卡顿，影响体验和效果
 - 提高性能充分利用处理器 
  



### 切片主要代码演示 

```jsx
import React, { useEffect } from &quot;react&quot;;

const Login: React.FC = () =&gt; {
  const chunkSize = 1 * 1024 * 1024; // 1M
  // 将文件切片
  const sliceFile = (file: File) =&gt; {
    // 切片的内容存放
    const chunks = [];
    // 切片的位置
    let offset = 0;

    while (offset &lt; file.size) {
      // 分割切片位置以及每次切片的大小
      const chunk = file.slice(offset, offset + chunkSize);
      chunks.push(chunk);
      // 切片的位置计算
      offset = offset + chunkSize;
    }
    return chunks;
  };

  // 上传的切片
  const uploadChunks = async (chunks: any) =&gt; {
    for (let i = 0; i &lt; chunks.length; i++) {
      const formData = new FormData();
      formData.append(&quot;fileChunk&quot;, chunks[i]);

      // 发送切片上传请求
      await fetch(&quot;/update&quot;, {
        method: &quot;POST&quot;,
        body: formData,
      });
    }
  };

  // 上传的主函数
  const uploadFile = async (file: File) =&gt; {
    const chunks = await sliceFile(file);

    await uploadChunks(chunks);
  };

  const click = () =&gt; {
    document.getElementById(&quot;upload&quot;)?.click();
  };

  useEffect(() =&gt; {
    document.getElementById(&quot;upload&quot;)?.addEventListener(&quot;change&quot;, (e) =&gt; {
      // 获得当前上传的文件
      const files = (e.target as HTMLInputElement).files?.[0];
      if (files) {
        uploadFile(files);
      }
    });
  }, []);

  return (
    &lt;div className=&quot;login&quot;&gt;
      &lt;h1&gt;大文件上传&lt;/h1&gt;
      &lt;button onClick={click}&gt; 选择上传文件&lt;/button&gt;
      &lt;input type=&quot;file&quot; id=&quot;upload&quot; style={{ display: &quot;none&quot; }} /&gt;
    &lt;/div&gt;
  );
};

export default Login;

```
效果如下
![1](http://img.blog.loli.wang/2024-05-27-webUpload/01.png)
![2](http://img.blog.loli.wang/2024-05-27-webUpload/02.png)



成功切片上传 但是会影响到页面卡顿 使用webworker




```jsx
//worker.ts

// 上传的切片
const uploadChunks = async (chunks: any) =&gt; {
  for (let i = 0; i &lt; chunks.length; i++) {
    const formData = new FormData();
    formData.append(&quot;fileChunk&quot;, chunks[i]);

    // 发送切片上传请求
    await fetch(&quot;/update&quot;, {
      method: &quot;POST&quot;,
      body: formData,
    });
  }
};

// 创建接收消息通知
this.addEventListener(&quot;message&quot;, async (event) =&gt; {
  const chunkSize = 1 * 1024 * 1024; // 1M
  const file = event.data.payload.file;
  // 切片的内容存放
  const chunks = [];
  // 切片的位置
  let offset = 0;

  while (offset &lt; file.size) {
    // 分割切片位置以及每次切片的大小
    const chunk = file.slice(offset, offset + chunkSize);
    chunks.push(chunk);
    // 切片的位置计算
    offset = offset + chunkSize;
  }

  //   上传切片
  await uploadChunks(chunks);

  // 通知完成
  postMessage({ type: &quot;uploadComplete&quot; });
});

```

主页面
```jsx
import React, { useEffect } from &quot;react&quot;;

const Login: React.FC = () =&gt; {
  const click = () =&gt; {
    document.getElementById(&quot;upload&quot;)?.click();
  };

  useEffect(() =&gt; {
    // 创建Worker的实例，并启动实例
    const worker = new Worker(&quot;src/pages/login/worker.ts&quot;);

    document.getElementById(&quot;upload&quot;)?.addEventListener(&quot;change&quot;, (e) =&gt; {
      // 获得当前上传的文件
      const files = (e.target as HTMLInputElement).files?.[0];

      // 接收消息
      worker.addEventListener(&quot;message&quot;, (event) =&gt; {
        const { type } = event.data;
        if (type === &quot;uploadComplete&quot;) {
          console.log(&quot;文件上传完成！&quot;);
        }
      });
      if (files) {
        // 向worker发送消息
        worker.postMessage({ type: &quot;upload&quot;, payload: { file: files } });
      }
    });
  }, []);

  return (
    &lt;div className=&quot;login&quot;&gt;
      &lt;h1&gt;大文件上传&lt;/h1&gt;
      &lt;button onClick={click}&gt; 选择上传文件&lt;/button&gt;
      &lt;input type=&quot;file&quot; id=&quot;upload&quot; style={{ display: &quot;none&quot; }} /&gt;
    &lt;/div&gt;
  );
};

export default Login;

```

完成配合使用webWorker

![1](http://img.blog.loli.wang/2024-05-27-webUpload/03.png)
![2](http://img.blog.loli.wang/2024-05-27-webUpload/04.png)




# 最近状态不好。。。看上去不能写的太细节，当作demo预览吧</div></div><div><img src="http://img.blog.loli.wang/2024-05-27-webUpload/01.png" class="w-[500px] h-[200px] rounded-r-lg object-cover" style="clip-path:polygon(0 0,100% 0,100% 100%,20% 100%)"></div></div></div></a></div><div class="ml-4 "><a href="/blog/2024-05-15-chromecubaoporxy/doc/index.html" title="chrome浏览器暴力解决跨域的方案"><div class="card bg-color postCard mb-4 rounded-lg w-full shadow-xl cursor-pointer	 flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div><img src="http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/02.png" class="w-[500px] h-[200px] rounded-l-lg" style="clip-path:polygon(0 0,88% 0,100% 100%,0 100%)"></div><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"> <time datetime="Wed May 15 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/15</time> </div><div class="text-sm mr-6">0.1K字</div><div class="text-sm">78 天前</div></div></div><div class="flex justify-between items-center mt-2"><div><div class="text-2xl font-medium title">chrome浏览器暴力解决跨域的方案</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed">
### 为什么会知道这个 

一个群交流看见的。 有这么个解决方案，记录下。毕竟有时候真的需要很粗暴的解决方式。

原先随意请求一个非同源的接口。

![处理前](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/01.png)
![处理后](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/05.png)

可以看到，现在报错是提示403错误。代表没有权限，也就是我们能正常请求到接口了，跨域已经处理成功了

### 步骤

首先右键我们的google浏览器，选择**属性**,**打开文件所在位置**，右键发送一个快捷方式到桌面

![1](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/02.png)

在鼠标右键刚刚新建的快捷方式，选择**属性**，在**目标**中**追加** 

 --disable-web-security 代表禁用同源策略
 --user-data-dir  代表用户缓存目录

``` bash

目标路径 --args --disable-web-security --user-data-dir=D:\MyChromeDevUserData

或

目标路径 --disable-web-security --user-data-dir=D:\MyChromeDevUserData

```
![2](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/03.png)

关闭所有谷歌浏览器进程，重新运行一下这个快捷方式，就可以看到

![4](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/04.png)

并且访问接口的时候，跨域也被解决掉了

![5](http://img.blog.loli.wang/2024-05-15-chromecubaoporxy/05.png)</div></div></div></div></a></div><div class="ml-4"><a href="/blog/2024-05-13-padandroidstudio01/doc/index.html" title="UNIAPP离线打包plus.runtime.install无法调起安装的解决方法"><div class="card bg-color cursor-pointer	 postCard rounded-lg w-full mb-4 shadow-xl flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"><time datetime="Mon May 13 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/13</time></div><div class="text-sm mr-6">0.1K字</div><div class="text-sm">80 天前</div></div></div><div class="flex justify-between items-center mt-2"><div class="w-5/6"><div class="text-2xl font-medium title line-clamp-1 leading-relaxed">UNIAPP离线打包plus.runtime.install无法调起安装的解决方法</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed"> 
### 起因

公司项目出现问题了，业务人员说设备APP升级了无法安装，我想了想最近除了改过业务类的代码，也没有动过其他代码啊，为什么会出现问题 ？

### 判断问题

1.  测试环境测试，云打包测试，打包后安装，可以安装。
2.  离线打包测试，打包后升级出现问题，无法出现问题，自从前一阵子切换成离线打包后就出现这个问题了。

### 发现问题。

![切1](http://img.blog.loli.wang/2024-05-13-padandroidStudio01/02.png)

下载完最新的安装包后，无法调起最新的安装包，而我又是最新的SDK。

看官方文档

 [针对plus.runtime.install在安卓9.0+上无法执行的解决方案](https://ask.dcloud.net.cn/article/35703)

使用**云打包**的话，只用在UNIAPP的manifest.json中添加相关的**权限**配置就好，但是离线打包的话，需要自己手动在 **Android Studio** 进行权限配置。

![切1](http://img.blog.loli.wang/2024-05-13-padandroidStudio01/03.png)

既然知道问题了，就进行修改吧。打开**Android Studio**，在**AndroidManifest.xml**中，找到**manifest**标签，在里面添加如下代码：

``` xml
  &lt;uses-permission android:name=&quot;android.permission.REQUEST_INSTALL_PACKAGES&quot;/&gt;
```

![切1](http://img.blog.loli.wang/2024-05-13-padandroidStudio01/04.png)

重新打包运行，成功安装。


### 相关文章
 [UNIAPP离线打包配置](https://blog.loli.wang/blog/2023-12-28-uniapppackage/doc/index.html)
</div></div><div><img src="http://img.blog.loli.wang/2024-05-13-padandroidStudio01/02.png" class="w-[500px] h-[200px] rounded-r-lg object-cover" style="clip-path:polygon(0 0,100% 0,100% 100%,20% 100%)"></div></div></div></a></div><div class="ml-4 "><a href="/blog/2024-05-04-manest/doc/index.html" title="Nestjs的微服务"><div class="card bg-color postCard mb-4 rounded-lg w-full shadow-xl cursor-pointer	 flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div><img src="http://img.blog.loli.wang/2024-05-04-MANest/01.png" class="w-[500px] h-[200px] rounded-l-lg" style="clip-path:polygon(0 0,88% 0,100% 100%,0 100%)"></div><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"> <time datetime="Sat May 04 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/4</time> </div><div class="text-sm mr-6">0.3K字</div><div class="text-sm">89 天前</div></div></div><div class="flex justify-between items-center mt-2"><div><div class="text-2xl font-medium title">Nestjs的微服务</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed">
## 2024 年 5月 3日

到晚上了，QQ没人找，微信没人回。当然这么好的假日应该出去玩才对，但是我不愿意浪费这点时间给自己好好休息。偶然看到了某技术群聊微服务，很有兴趣，看资料折腾下吧。


## 使用nest的cli工具创建项目

```bash
# 全局安装nestjs的cli
npm i -g @nestjs/cli

# 安装第一个项目
nest new aa

# 启动aa项目
cd aa
pnpm run start
```

![切1](http://img.blog.loli.wang/2024-05-04-MANest/01.png)

启动访问成功

![切2](http://img.blog.loli.wang/2024-05-04-MANest/02.png)

## 创建一个 微服务项目

``` bash
# 通过cli安装一个新的项目
nest new micro-service

# 安装nestjs 微服务插件
pnpm add @nestjs/microservices
```

## 引用 @nestjs/microservices 修改main.ts

将原本启动http服务,改为启动微服务

```jsx
// main.ts

import { NestFactory } from &#39;@nestjs/core&#39;;
import { AppModule } from &#39;./app.module&#39;;
import { Transport, MicroserviceOptions } from &#39;@nestjs/microservices&#39;;

async function bootstrap() {
  // const app = await NestFactory.create(AppModule);

  const app = await NestFactory.createMicroservice&lt;MicroserviceOptions&gt;(
    AppModule,
    {
      transport: Transport.TCP,
      options: {
        port: 8888,
      },
    },
  );

  await app.listen();
}
bootstrap();

```


修改 **app.controller.ts** 改为接受Message通知，

```jsx
// app.controller.ts

import { Controller, Get } from &#39;@nestjs/common&#39;;
import { AppService } from &#39;./app.service&#39;;
import { MessagePattern } from &#39;@nestjs/microservices&#39;;

@Controller()
export class AppController {
  constructor(private readonly appService: AppService) {}

  @MessagePattern(&#39;sum&#39;)
  sum(numArr: Array&lt;number&gt;): number {
    return numArr.reduce((total, item) =&gt; total + item, 0);
  }
}

```


## 改造 aa 项目，让他能够连接微服务

```bash
# 安装微服务依赖
pnpm add @nestjs/microservices

```

进入 app.module.ts 注册**微服务**那个项目,指定TCP端口为8888，让他直到我们的微服务项目端口是8888

```jsx
import { Module } from &#39;@nestjs/common&#39;;
import { AppController } from &#39;./app.controller&#39;;
import { AppService } from &#39;./app.service&#39;;
import { ClientsModule, Transport } from &#39;@nestjs/microservices&#39;;

@Module({
  imports: [

    ClientsModule.register([
      {
        name: &#39;MICRO_SERVICE&#39;,
        transport: Transport.TCP,
        options: {
          port: 8888,
        },
      },
    ]),

  ],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}

```

![切2](http://img.blog.loli.wang/2024-05-04-MANest/03.png)

这样就注册完了。 然后在 **aa** 项目中注册客户端代理**clientProxy**


```jsx
//app.controller.ts

import { Controller, Get, Query, Inject } from &#39;@nestjs/common&#39;;
// import { AppService } from &#39;./app.service&#39;;
import { ClientProxy } from &#39;@nestjs/microservices&#39;;
import { Observable } from &#39;rxjs&#39;;

@Controller()
export class AppController {
  constructor(@Inject(&#39;MICRO_SERVICE&#39;) private serviceClient: ClientProxy) {}

  @Get()
  server(@Query(&#39;num&#39;) str): Observable&lt;number&gt; {
    const numArr = str.split(&#39;,&#39;).map((item) =&gt; parseInt(item));

    return this.serviceClient.send(&#39;sum&#39;, numArr);
  }
}

```


重启下微服务，查看结果

访问 aa 服务的看看是否有进行一个累加的计算 http://localhost:3000/?num=1,2,3

能够正常进行的互相传递接收，微服务配置成功

![切2](http://img.blog.loli.wang/2024-05-04-MANest/04.png)
![切2](http://img.blog.loli.wang/2024-05-04-MANest/05.png)




## 总结

照葫芦画瓢整的，虽然能够理解，但是目前没有合适的东西能让我启用这一套，当作学习记录一下吧


[神说要有光 - 掘金](https://juejin.cn/post/7207637337571901495?searchId=202405032014240A690D4981415C621CB4)

[我的github - nestjs 微服务demo](https://github.com/itmowang/nest-microservices-demo)
</div></div></div></div></a></div><div class="ml-4"><a href="/blog/2024-05-05-angulardevinit/doc/index.html" title="搭建第一个Angular的Demo"><div class="card bg-color cursor-pointer	 postCard rounded-lg w-full mb-4 shadow-xl flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"><time datetime="Sat May 04 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/4</time></div><div class="text-sm mr-6">0.1K字</div><div class="text-sm">89 天前</div></div></div><div class="flex justify-between items-center mt-2"><div class="w-5/6"><div class="text-2xl font-medium title line-clamp-1 leading-relaxed">搭建第一个Angular的Demo</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed"> 
## 2024 年 5月 5日

练完车，回来了, 明天又要上班了。工作是没有什么能给人内心带来充实的。只有学点东西能带来一点。

## 为什么要学Angular

身边太多Angular爱好者了，感觉不稍微学点融不进圈子，让人有很大的落差感。

我认为想熟悉一个前端框架，必须要从他的生态入手，脚手架是官方提供的一个工具，我也需要从脚手架开始这样才能一步一步慢慢理解


## Angular官网
```
https://angular.dev/overview
```

## 安装Angular官方的CLI工具

```bash
npm install -g @angular/cli
```

## 使用 NG 指令搭建一个新项目

```bash
ng new &lt;项目名&gt;
```

![切1](http://img.blog.loli.wang/2024-05-05-angulardevInit/01.png)


安装成功后 ， 使用指令 **pnpm run start**进行启动。

![切2](http://img.blog.loli.wang/2024-05-05-angulardevInit/02.png)



## 总结

虽然使用cli安装项目成功跑起来了,语法也很熟悉，还需要想办法熟下，挖个坑**后续使用Angular做我的图床程序**

[Anglar官网](https://angular.dev/guide/templates/interpolation)

</div></div><div><img src="http://img.blog.loli.wang/2024-05-05-angulardevInit/03.png" class="w-[500px] h-[200px] rounded-r-lg object-cover" style="clip-path:polygon(0 0,100% 0,100% 100%,20% 100%)"></div></div></div></a></div><div class="ml-4 "><a href="/blog/2024-05-03-prismanestapi/doc/index.html" title="使用Nestjs + prisma 构建 REST API"><div class="card bg-color postCard mb-4 rounded-lg w-full shadow-xl cursor-pointer	 flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div><img src="http://img.blog.loli.wang/2024-05-03-prismaNestApi/14.png" class="w-[500px] h-[200px] rounded-l-lg" style="clip-path:polygon(0 0,88% 0,100% 100%,0 100%)"></div><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"> <time datetime="Fri May 03 2024 23:27:24 GMT+0800 (中国标准时间)">2024/5/3</time> </div><div class="text-sm mr-6">0.8K字</div><div class="text-sm">90 天前</div></div></div><div class="flex justify-between items-center mt-2"><div><div class="text-2xl font-medium title">使用Nestjs + prisma 构建 REST API</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed">
## 2024 年 5月 3日

难得的51假期,5天假期，本应该是好好去玩的一天，可惜没有什么地方可以去，并且还报了驾校正在练车，正好今天没有安排，正好熟悉下nestjs吧。


### 使用nest cli 安装nest空项目

```bash
# 创建空的 nest 项目
npx @nestjs/cli new &lt;项目名&gt;
```
![切01](http://img.blog.loli.wang/2024-05-03-prismaNestApi/01.png)

启动正常

![切03](http://img.blog.loli.wang/2024-05-03-prismaNestApi/02.png)

### 安装prisma, 并初始化

```bash
# 安装prisma
pnpm install -D prisma

# 初始化prisma
npx prisma init
```
会增加一个prisma 的文件夹， 里面的schenma.prisma 是我们的数据库配置文件

![切03](http://img.blog.loli.wang/2024-05-03-prismaNestApi/03.png)
![切04](http://img.blog.loli.wang/2024-05-03-prismaNestApi/04.png)


### 本地安装mysql

比较常规，每个人情况不一样，我在这里使用的mysql


### 配置env环境变量

在初始化prisma的时候，会生成一个env的配置文件，使用env文件配置环境变量,如果你是用的其他的数据库参考文档
https://www.prisma.io/docs/orm/reference/connection-urls

我这里使用的是mysql，先修改指定数据库然后修改env配置

```jsx
// prisma/schema.prisma
datasource db {
  provider = &quot;mysql&quot;
  url      = env(&quot;DATABASE_URL&quot;)
}
```

```bash
DATABASE_URL=&quot;DATABASE_URL=&quot;mysql://prisma:123456@localhost:3306/prisma&quot;
```

### 增加数据模型

此处是定义了一个 Article的表 内有相关字段，以及字段代表的类型

```jsx
// prisma/schema.prisma

model Article {
  id          Int      @id @default(autoincrement())
  title       String   @unique
  description String?
  body        String
  published   Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
```


### 第一次执行
当你定义好数据模型后 我们需要执行一次指令 让数据库和prisma同步, 你也可以记录到package.json中的script指令中

```bash
# 指令
npx prisma migrate dev --name &quot;init&quot;
```

![切05](http://img.blog.loli.wang/2024-05-03-prismaNestApi/05.png)

![切06](http://img.blog.loli.wang/2024-05-03-prismaNestApi/06.png)


执行成功后，这里可以看到我们的数据库内自动生成了，我们刚刚设置的模型。每次修改我们的数据库模型都要去生成一遍。


### 增加默认数据填充数据库

创建一个为 **prisma/seed.ts** 的文件，

```jsx

// prisma/seed.ts

import { PrismaClient } from &#39;@prisma/client&#39;;

// initialize Prisma Client
const prisma = new PrismaClient();

async function main() {
  // create two dummy articles
  const post1 = await prisma.article.upsert({
    where: { title: &#39;Prisma Adds Support for MongoDB&#39; },
    update: {},
    create: {
      title: &#39;Prisma Adds Support for MongoDB&#39;,
      body: &#39;Support for MongoDB has been one of the most requested features since the initial release of...&#39;,
      description:
        &quot;We are excited to share that today&#39;s Prisma ORM release adds stable support for MongoDB!&quot;,
      published: false,
    },
  });

  const post2 = await prisma.article.upsert({
    where: { title: &quot;What&#39;s new in Prisma? (Q1/22)&quot; },
    update: {},
    create: {
      title: &quot;What&#39;s new in Prisma? (Q1/22)&quot;,
      body: &#39;Our engineers have been working hard, issuing new releases with many improvements...&#39;,
      description:
        &#39;Learn about everything in the Prisma ecosystem and community from January to March 2022.&#39;,
      published: true,
    },
  });

  console.log({ post1, post2 });
}

// execute the main function
main()
  .catch((e) =&gt; {
    console.error(e);
    process.exit(1);
  })
  .finally(async () =&gt; {
    // close Prisma Client at the end
    await prisma.$disconnect();
  });


```

在package.json中添加, 该命令使用 npx prisma db seed 的时候会自动执行，这样数据库内就会自动增加2条数据

```bash
npx prisma db seed
```

``` jsx
 &quot;prisma&quot;: {
    &quot;seed&quot;: &quot;ts-node prisma/seed.ts&quot;
 }
```

![切06](http://img.blog.loli.wang/2024-05-03-prismaNestApi/07.png)
![切08](http://img.blog.loli.wang/2024-05-03-prismaNestApi/08.png)

### 创建 Prisma 服务

nest提供了一个直接使用cli生成模块和服务的指令

```bash
npx nest generate module prisma
npx nest generate service prisma
```


### 设置 swagger

Swagger是一个使用 API 规范记录 API 的工具。 Nest 有一个专门用于 Swagger 的模块。

```bash
# 安装@nestjs/swagger 和  swagger-ui-express
pnpm install --save @nestjs/swagger swagger-ui-express
```

在 **main.ts**中初始化 swagger

```jsx
import { NestFactory } from &#39;@nestjs/core&#39;;
import { AppModule } from &#39;./app.module&#39;;
import { SwaggerModule, DocumentBuilder } from &#39;@nestjs/swagger&#39;;

async function bootstrap() {
  const app = await NestFactory.create(AppModule);

  const config = new DocumentBuilder()
    .setTitle(&#39;Median&#39;)
    .setDescription(&#39;The Median API description&#39;)
    .setVersion(&#39;0.1&#39;)
    .build();

  const document = SwaggerModule.createDocument(app, config);
  SwaggerModule.setup(&#39;api&#39;, app, document);

  await app.listen(3000);
}
bootstrap();

```


我们启动一下,可以看到 **/api** 加上路径后，swagger访问正常



![切08](http://img.blog.loli.wang/2024-05-03-prismaNestApi/09.png)


### 生成 REST 资源

可以看到swagger虽然正常了 但是我们目前还没有任何的接口去供我们查阅api。

```bash
# 快速生成REST资源
npx nest generate resource
```
使用指令可以快速帮我们生成**REST**资源，供我们修改使用，重新启动一下。可以看到出现了我们需要的REST接口资源


![切10](http://img.blog.loli.wang/2024-05-03-prismaNestApi/10.png)




### 连接prisma 进行CURD

可以看到我们的api资源对应的，都是 **@Body(),@Query()** 等装饰器来生成这个API。

![切11](http://img.blog.loli.wang/2024-05-03-prismaNestApi/11.png)

但是要让 **Swagger** 访问到我们的**prsima** 进行**CURD**操作还需要一定的步骤,进入到我们的articles.module.ts文件，引入Prisma的模型.

```jsx
// src/articles/articles.module.ts

import { Module } from &#39;@nestjs/common&#39;;
import { ArticlesService } from &#39;./articles.service&#39;;
import { ArticlesController } from &#39;./articles.controller&#39;;
import { PrismaModule } from &#39;src/prisma/prisma.module&#39;;

@Module({
  controllers: [ArticlesController],
  providers: [ArticlesService],
  imports: [PrismaModule],
})
export class ArticlesModule {}

```

将 **PrismaService**注入到**ArticlesService** 中, 并且使用他来访问数据库，需要增加一个构造函数


```jsx
// src/articles/articles.service.ts
import { Injectable } from &#39;@nestjs/common&#39;;
import { CreateArticleDto } from &#39;./dto/create-article.dto&#39;;
import { UpdateArticleDto } from &#39;./dto/update-article.dto&#39;;
import { PrismaService } from &#39;src/prisma/prisma.service&#39;;

@Injectable()
export class ArticlesService {
  constructor(private prisma: PrismaService) {}
    //   ...CURD
}

```



### 更改一个测试接口用来测试

我只需要简单写一个接口，查询出表**article**所有数据。看看是否成功 。

```jsx
// src/articles/articles.service.ts

import { Injectable } from &#39;@nestjs/common&#39;;
import { CreateArticleDto } from &#39;./dto/create-article.dto&#39;;
import { UpdateArticleDto } from &#39;./dto/update-article.dto&#39;;
import { PrismaService } from &#39;src/prisma/prisma.service&#39;;

@Injectable()
export class ArticlesService {
  constructor(private prisma: PrismaService) {}
  create(createArticleDto: CreateArticleDto) {
    return &#39;This action adds a new article&#39;;
  }

  findAll() {
    return this.prisma.article.findMany({});
  }

  findOne(id: number) {
    return `This action returns a #${id} article`;
  }

  update(id: number, updateArticleDto: UpdateArticleDto) {
    return `This action updates a #${id} article`;
  }

  remove(id: number) {
    return `This action removes a #${id} article`;
  }
}


```

![切12](http://img.blog.loli.wang/2024-05-03-prismaNestApi/12.png)
![切13](http://img.blog.loli.wang/2024-05-03-prismaNestApi/13.png)
![切14](http://img.blog.loli.wang/2024-05-03-prismaNestApi/14.png)


### 相关文章

[Prsima 官网](https://www.prisma.io/blog/nestjs-prisma-rest-api-7D056s1BmOL0#introduction)

[Github编写的示例DEMO](https://github.com/itmowang/prisma-nest-mysql-demo)
</div></div></div></div></a></div><div class="ml-4"><a href="/blog/2024-04-30-linuxnginx/doc/index.html" title="关于帮网友解决linux安装Nginx，并配置SSL这回事"><div class="card bg-color cursor-pointer	 postCard rounded-lg w-full mb-4 shadow-xl flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"><time datetime="Tue Apr 30 2024 23:27:24 GMT+0800 (中国标准时间)">2024/4/30</time></div><div class="text-sm mr-6">0.3K字</div><div class="text-sm">93 天前</div></div></div><div class="flex justify-between items-center mt-2"><div class="w-5/6"><div class="text-2xl font-medium title line-clamp-1 leading-relaxed">关于帮网友解决linux安装Nginx，并配置SSL这回事</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed"> 
## 忙碌的一天

前天非常忙碌，客户那边问题挺多的，忙了一天解决了大部分事情。5:30分的时候，一网友问出了奇怪的问题。

![切01](http://img.blog.loli.wang/2024-04-30-linuxnginx/01.png)

浅想一下
```他或许是想问这个Nginx配置前端来配置好，还是后端配置好。```

![切01](http://img.blog.loli.wang/2024-04-30-linuxnginx/02.png)

哦。。原来是NGINX让他来配置了，而他这边有点问题

远程帮忙看了下，用的 **腾讯云** , 并且自带Nginx，尝试直接配置反向代理。


``` bash

#user  nobody;
worker_processes  1;


events {
    worker_connections  1024;
}


http {
    include       mime.types;
    default_type  application/octet-stream;

    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    #gzip  on;

   server {
    listen 443 ssl;
    server_name your-domain.com;
 
    ssl_certificate ./ssl/nxesp.cn_bundle.crt; # SSL证书文件路径
    ssl_certificate_key ./ssl/nxesp.cn_bundle.key; # SSL证书密钥文件路径
 
    # SSL配置
    ssl_session_timeout 1d;
    ssl_session_cache shared:SSL:50m;
    ssl_session_tickets off;
 
    # 指定加密套件（Suites）
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers &#39;ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384&#39;;
    ssl_prefer_server_ciphers on;
 
    location / {
        proxy_pass https://your-backend-server; # 后端服务器地址
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

```

看上去 配置没有问题，但是腾讯云上自带的nginx没有ssl套件，所以需要手动安装。我觉着太麻烦了。。直接重装吧

1. 卸载nginx 

```bash 

killall nginx

yum remove nginx

rm -rf /usr/local/nginx
```


2. 安装nginx

``` bash
yum install nginx

#测试启动
systemctl start nginx
```
访问相应端口 安装成功


2. 配置SSL

SSL文件放入到 /etc/nginx/conf/ssl/ (我个人喜欢新建一个ssl文件夹存放ssl文件，这样方便直接./去调用),将我们的原有配置复制到新的配置文件中

```bash
 server {
    listen 443 ssl;
    server_name your-domain.com;
 
    ssl_certificate ./ssl/nxesp.cn_bundle.crt; # SSL证书文件路径
    ssl_certificate_key ./ssl/nxesp.cn_bundle.key; # SSL证书密钥文件路径
 }
```

3. 检测 Nginx 配置文件

```bash
cd /etc/nginx/

# 检查配置文件语法是否正确
nginx -t

# 重启Nginx
systemctl restart nginx
```

正常后，会显示类似下面的信息：

```bash
 nginx success .... （具体不记得）
```


![切03](http://img.blog.loli.wang/2024-04-30-linuxnginx/03.png)


嗯 看上去没问题了~


#### Centos 常用NGinx命令

```bash

# 启动nginx
systemctl start nginx

# 停止nginx
systemctl stop nginx

# 重启nginx
systemctl restart nginx

# 查看nginx状态
systemctl status nginx

# 配置nginx开机自启动
systemctl enable nginx

# 配置nginx开机不启动
systemctl disable nginx

# 查看nginx日志
cat /var/log/nginx/error.log

# 查看nginx进程
ps -ef | grep nginx

# 查看nginx配置文件
cat /etc/nginx/nginx.conf

# 检查配置文件语法是否正确
nginx -t
```</div></div><div><img src="http://img.blog.loli.wang/2024-04-30-linuxnginx/01.png" class="w-[500px] h-[200px] rounded-r-lg object-cover" style="clip-path:polygon(0 0,100% 0,100% 100%,20% 100%)"></div></div></div></a></div><div class="ml-4 "><a href="/blog/2024-04-15-linuxserver/doc/index.html" title="记一次配置小主机装Ubuntu"><div class="card bg-color postCard mb-4 rounded-lg w-full shadow-xl cursor-pointer	 flex relative hover:shadow-md transition ease-in-out delay duration-300 hover:scale-95"><div class="flex"><div><img src="http://img.blog.loli.wang/2024-04-15-linuxServer/17.jpg" class="w-[500px] h-[200px] rounded-l-lg" style="clip-path:polygon(0 0,88% 0,100% 100%,0 100%)"></div><div class="w-full p-4"><div class="flex justify-between"><div></div><div class="flex tools"><div class="text-sm mr-6"> <time datetime="Mon Apr 15 2024 23:27:24 GMT+0800 (中国标准时间)">2024/4/15</time> </div><div class="text-sm mr-6">0.3K字</div><div class="text-sm">108 天前</div></div></div><div class="flex justify-between items-center mt-2"><div><div class="text-2xl font-medium title">记一次配置小主机装Ubuntu</div></div><div class="text-sm text-gray-500">日常生活</div></div><div class="text-sm text-gray-500 mt-3 line-clamp-4 leading-relaxed">
## 因为 Switch 送人了，而在 PC 上玩模拟不痛快，就想着整个小主机装个 ubuntu 然后装模拟器给电视机用

# **预算定为 500 块**

1. 选购小主机

    在选择小主机的时候，我观察了很多，如果买现成的 ，网上大部分 cpu 大部分都是 N100 的处理器，性能偏弱，价格也在 1000 块钱左右，并且硬盘很少，内存也就给 8g，并不能满足日常生活需要，所以考虑选择自己配，看了许多配置后，选定如下配置。

    1. CPU：酷睿 i5-8500T 散片 (淘宝:357 RMB)

    2. RAM：海力士 ddr4 3200mhz *2 (咸鱼: 160 RMB)

    3. 硬盘：金士顿 m2 500G SSD (咸鱼: 210 RMB)

    4. 主机: 准系统 DELL 戴尔 7060MFF (咸鱼:330 RMB)

    合计 : 1057 RMB

    以上配置，个人感觉还是能够接受的，虽然超预算了。。。

![切图01](http://img.blog.loli.wang/2024-04-15-linuxServer/01.jpg)
![切图02](http://img.blog.loli.wang/2024-04-15-linuxServer/02.png)


2. 装配小主机

准系统的小主机装配很简单，把内存 cpu 硬盘安装好，插上电源直接用就行。

![切图03](http://img.blog.loli.wang/2024-04-15-linuxServer/03.jpg)
![切图04](http://img.blog.loli.wang/2024-04-15-linuxServer/04.jpg)
![切图05](http://img.blog.loli.wang/2024-04-15-linuxServer/05.jpg)
![切图06](http://img.blog.loli.wang/2024-04-15-linuxServer/06.jpg)
![切图07](http://img.blog.loli.wang/2024-04-15-linuxServer/07.jpg)
![切图08](http://img.blog.loli.wang/2024-04-15-linuxServer/08.jpg)

3. 点亮小主机

顺利点亮小主机，二手收的硬盘里装有一个自带的windows 11，发现上一任硬盘装的各种资料。。

![切图09](http://img.blog.loli.wang/2024-04-15-linuxServer/09.jpg)
![切图10](http://img.blog.loli.wang/2024-04-15-linuxServer/10.jpg)
![切图11](http://img.blog.loli.wang/2024-04-15-linuxServer/11.jpg)
![切图12](http://img.blog.loli.wang/2024-04-15-linuxServer/12.jpg)
![切图13](http://img.blog.loli.wang/2024-04-15-linuxServer/13.jpg)


嗯。。。 虽然离谱。给他格式化吧。


4. 给小主机装ubuntu系统

小主机装配完毕了，是时候安装linux系统了，我自己的想法是先安装图形化界面的，后面再看着办，

原本的想法 

- **分配10G的硬盘，10G的硬盘里装ios镜像，然后安装ubuntu**

因为u盘忘记放哪儿了，就准备采取上面的方案。但是试了很多次，总是出现错误。一会说不能插入网卡，等各种问题，好不容易进了安装界面，一会说不能找不到U盘。 (毕竟我也只有一块硬盘)

![切图14](http://img.blog.loli.wang/2024-04-15-linuxServer/14.jpg)
![切图15](http://img.blog.loli.wang/2024-04-15-linuxServer/15.jpg)



- **连夜买了个u盘**

因为这问题纠结太久了，夜晚比较浮躁，美团买了个u盘，用了优惠券 16g 20RMB，

使用 **Etcher** 工具少烧录了，直接uefi模式启动，顺利安装 unbuntu 

![切图16](http://img.blog.loli.wang/2024-04-15-linuxServer/17.jpg)



5. 最终结果。

我最后还是失败了。在安装模拟器的过程中，发现到生态多烂多不完善，各种工具安装不上，安装好模拟器模拟器还乱码。和服务器语言有关，切换后正常了，下载模拟器游戏也各种不方便，最后还是放弃。。。 （或许过几天我还是会继续尝试下），但是感觉除了做服务器环境，用linux的话，还是不怎么好用的。。。
</div></div></div></div></a></div><div class="pagination-container page-bar flex items-center justify-between bg-white p-4 rounded-md shadow-md"> <a href="/page/1/" class="prev text-blue-500 hover:text-blue-700 transition-colors duration-200" title="上一页">
上一页
</a> <span class="pagination-info text-gray-700">
第 2 页 / 共 7 页
</span> <a href="/page/3/" class="next text-blue-500 hover:text-blue-700 transition-colors duration-200" title="下一页">
下一页
</a> </div> </div> </div> </div>  </div> <footer data-astro-cid-sz7xmlte>
&copy; 2024 Your name here. All rights reserved.
<div class="social-links" data-astro-cid-sz7xmlte> <a href="https://m.webtoo.ls/@astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Mastodon</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/mastodon" data-astro-cid-sz7xmlte><path fill="currentColor" d="M11.19 12.195c2.016-.24 3.77-1.475 3.99-2.603.348-1.778.32-4.339.32-4.339 0-3.47-2.286-4.488-2.286-4.488C12.062.238 10.083.017 8.027 0h-.05C5.92.017 3.942.238 2.79.765c0 0-2.285 1.017-2.285 4.488l-.002.662c-.004.64-.007 1.35.011 2.091.083 3.394.626 6.74 3.78 7.57 1.454.383 2.703.463 3.709.408 1.823-.1 2.847-.647 2.847-.647l-.06-1.317s-1.303.41-2.767.36c-1.45-.05-2.98-.156-3.215-1.928a3.614 3.614 0 0 1-.033-.496s1.424.346 3.228.428c1.103.05 2.137-.064 3.188-.189zm1.613-2.47H11.13v-4.08c0-.859-.364-1.295-1.091-1.295-.804 0-1.207.517-1.207 1.541v2.233H7.168V5.89c0-1.024-.403-1.541-1.207-1.541-.727 0-1.091.436-1.091 1.296v4.079H3.197V5.522c0-.859.22-1.541.66-2.046.456-.505 1.052-.764 1.793-.764.856 0 1.504.328 1.933.983L8 4.39l.417-.695c.429-.655 1.077-.983 1.934-.983.74 0 1.336.259 1.791.764.442.505.661 1.187.661 2.046v4.203z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://twitter.com/astrodotbuild" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Follow Astro on Twitter</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/twitter" data-astro-cid-sz7xmlte><path fill="currentColor" d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z" data-astro-cid-sz7xmlte></path></svg> </a> <a href="https://github.com/withastro/astro" target="_blank" data-astro-cid-sz7xmlte> <span class="sr-only" data-astro-cid-sz7xmlte>Go to Astro's GitHub repo</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" astro-icon="social/github" data-astro-cid-sz7xmlte><path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-sz7xmlte></path></svg> </a> </div> </footer>  </div> </div> </main> </body></html>